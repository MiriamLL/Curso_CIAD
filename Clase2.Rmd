---
title: "Clase 2"
subtitle: "Graficos"
author: "Miriam Lerma"
date: "Febrero 2021"
output:
  xaringan::moon_reader:
    css: ["default","middlebury-fonts"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: true
---

# 1. Intro

La clase es de 2 horas.

Hoy: 

- ~40 minutos de teoría  
(porque hacer graficos, que es ggplot y conceptos básicos para crear graficos)

--

- ~15 minutos de practica  
Van a abrir R, crear un grafico basico y no guarden su script o no cierren R.

--

- 10 minutos de receso, siesta, café u otros.
También pueden ser para resolver dudas.

--

- ~30 minutos de teoría.  
(cambiar la estetica de mis graficos)

--

- ~20 minutos de practica.  
Van a cambiar la estetica de su grafico.

--

Si da tiempo:  
Un poco de inspiracion y la infinidad de opciones de graficos.

---

# Quienes son ustedes? (...por hoy)

.pull-left[
Ademas de muy madrugadores

```{r, echo=FALSE, out.height=200}
knitr::include_graphics("https://images.unsplash.com/photo-1601315447719-cf782668d24e?ixid=MXwxMjA3fDB8MHxzZWFyY2h8NDJ8fHJvb3N0ZXJ8ZW58MHx8MHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60")

```
]
--

.pull-right[
- Conocimientos basicos de R (saben abrirlo, cargar paquetes y datos)

- Quieren hacer graficos con sus datos usando R
]

---

class: center, middle

# Como quiero que salgan.

.pull-left[
Haciendo graficos maravillosos que quieran presumir  
```{r, echo=FALSE, out.height=250}
knitr::include_graphics("https://images.unsplash.com/photo-1496740019327-63371ac821e4?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=802&q=80")
```
]

--
.pull-right[
Pero por ahora:

- Sepan como graficar sus datos

]

---

# Créditos

-Todo el material basado en el libro:  
[R4DS, editado por Riva Quiroga](https://r4ds-en-espaniol.netlify.app/)  

-Y el libro de:  
[Bookdown, por Sonia Mendizabal](https://songeo.github.io/introduccion-r-bookdown/)

-Y materiales de RLadies   
[Zero to Hero](https://github.com/rladies/meetup-presentations_freiburg)  
[Recursos en espanol ](https://github.com/rladies/recursos_en_espanol)  
[RdesdeCero por Yanina Bellini](https://github.com/rladies/meetup-presentations_santarosa/blob/master/RdesdeCero)  
[Primeros pasos en R por Riva Quuiroga](https://github.com/rivaquiroga/RLadies-Santiago/blob/master/2018-04_taller_primeros_pasos_en_R.Rmd)  


Imagenes adicionales
[Unsplash](https://unsplash.com/)

---
class: center, middle

# Empecemos

---

# 1.1. Teoria

El objetivo de un grafico es comunicar

En ciencia, un grafico simple a veces es mejor porque la idea es brindar informacion.

--

Hay muchos paquetes para hacer graficos ademas de ggplot2
pero ggplot es uno de los mas versatiles
... y del que encuentras mas ayuda e inspiracion.

---

# 1.2. Como funciona?

- A statistical graphic is a mapping data variables to aesthethic attributes of geometric objects

Para objetivos practicos, un grafico se puede dividir en tres componentes esenciales:  
- Datos (data): conjunto de datos compuesto por varables que mapeamos.  
- Geometria (geom): objeto geometrico en cuestion. Puntos, lineas, barras?  
- Estetica (aes): atributos esteticos del objeto geometrico, posicion color, forma, tamanio.

ggplot funciona por capas, si han usado SIG (sistema de informacion geografica) estaran mas familiarizados.


---

# 1.3. Practica a la par
## Instalar y cargar

```{r, eval=FALSE}
install.packages("ggplot2")
```

Otros paquetes que nos seran utiles hoy
```{r, message=FALSE}
library(datos)
library(tidyverse)
library(ggplot2)
```

---

# 1.3. Practica 
### Instalar y cargar

Cargar datos de prueba
```{r}
Prueba<-datos::clima
```

---

# 1.3. Practica 
### Agregar datos

```{r, fig.height=5}
ggplot(data=Prueba)
```

Paso algo?

---

# 1.3. Practica
### Agregar ejes

Abran su tabla, que columnas tenemos.  
Darle informacion de los ejes.  
Noten que sus ejes tienen que ser columnas en su tabla.  
```{r, fig.height=4}
ggplot(data=Prueba, mapping=aes(x=humedad,y=visibilidad))
```

Ok, tenemos los ejes.

---

# 1.3. Practica
### Agregar geometria

```{r, fig.height=5, warning=FALSE}
ggplot(data=Prueba, mapping=aes(x=humedad,y=visibilidad))+
  geom_point()
```
  
Nota: te salio un warning?
Que dice el warning?


---

# 1.4. Tipos de graficos

Hoy: 
- Puntos
- Lineas
- Barras
- Boxplots
- Trajectorias 
- Mapas

... pero hay muchos mas.

---

# 1.4. Tipos de graficos
### Grafico de puntos, diagramas de dispersion, o scatterplot

Datos inventados de camarones, tamanio y densidad del cultivo.
```{r, fig.height=5}
Especies<-c('Lito','Lito','Lito','Lito','Lito')
Camarones<-as.data.frame(Especies)
Camarones$Tamanio<-c(1.5,1.6,1.8,1.9,2.1)
Camarones$Densidad<-c(100,200,300,400,500)
```

---

# 1.4. Tipos de graficos
### Grafico de puntos
Diagramas de dispersion, o scatterplot

Grafico de datos inventados de camarones, tamanio y densidad del cultivo.
```{r, fig.height=4}
ggplot(data=Camarones,mapping=aes(x=Tamanio, y=Densidad))+
  geom_point() #<<
```




---

# 1.4. Tipos de graficos
### Grafico de lineas

Datos inventados de tipo de algas, en meses (tiempo) y densidad (cantidad)
```{r}
Algas<-c('B','E','B','B','B','B','E','B','E','B')
MareaRoja<-as.data.frame(Algas)
MareaRoja$Tiempo<-c(1,2,3,4,5,6,7,8,9,10)
MareaRoja$Cantidad<-c(100,200,300,200,200,300,400,500,700,200)
```

---

# 1.4. Tipos de graficos
### Grafico de lineas

Grafico de datos inventados de tipo de bacterias, meses (tiempo) y densidad (cantidad)
```{r, fig.height=4}
ggplot(data=MareaRoja,mapping=aes(x=Tiempo, y=Cantidad))+
  geom_line() #<<
```


---

# 1.4. Tipos de graficos
### Grafico de barras

Datos Inventados de microbiota vaginal en mujeres de diferente edad, y densidad (cantidad)
```{r}
Microbiota<-c('B','E','B','B','B','B','E','B','E','B')
Microbiota<-as.data.frame(Microbiota)
Microbiota$Edad<-c(20,25,30,35,40,45,50,55,60,65)
Microbiota$Cantidad<-c(100,200,300,200,200,300,400,500,700,200)
```

---

# 1.4. Tipos de graficos
### Grafico de barras

Grafico de Datos Inventados
```{r, fig.height=4, eval=FALSE}
ggplot(data=Microbiota,mapping=aes(x=Edad, y=Cantidad))+
  geom_bar() #<<
```
Error: stat_count() can only have an x or y aesthetic.

---


# 1.4. Tipos de graficos
### Grafico de barras

Grafico de datos inventados de microbiota por edad y cantidades
```{r, fig.height=4}
ggplot(data=Microbiota,mapping=aes(x=Edad, y=Cantidad))+
  geom_bar(stat='identity') #<<
```



---

# 1.4. Tipos de graficos
### 1.6. Boxplot

Datos inventados de salinidad en Bahia de Santa Maria diferencias en las estaciones muestreadas
```{r}
Salinidad<-c(38,39,38,37,36,40,38,36,35,38)
Mes<-c(1,2,3,4,5,6,7,8,9,10)
Estacion<-c(1,1,1,1,1,2,2,2,2,2)
BSM<-as.data.frame(Salinidad)
BSM$Mes<-Mes
BSM$Estacion<-as.factor(Estacion)
```

---

# 1.4. Tipos de graficos
### 1.6. Boxplot

Grafico de datos inventados de salinidad en Bahia de Santa Maria diferencias en las estaciones muestreadas.
```{r, fig.height=5}
ggplot(data = BSM, aes(x=Estacion, y = Salinidad, group=Estacion)) +
  geom_boxplot() #<<
```


---

# 1.4. Tipos de graficos
### Trayectorias

Datos inventados de un bobo cafe que tenemos datos de latitud y longitud.
```{r}
Latitud<-c(8,9,10,9,8,6,5,9,8,7,6,5) #eje x
Longitud<-c(5,6,7,6,5,4,3,4,5,6,7,5) #eje y
Bobos<-as.data.frame(Longitud)
Bobos$Latitud<-Latitud
```

---

# 1.4. Tipos de graficos
### Trayectorias

Graficos de datos inventados de un bobo cafe que tenemos datos de latitud y longitud.
```{r, fig.height=5}
ggplot(data = Bobos, aes(x = Latitud, y = Longitud)) +
  geom_path() #<<
```

---

# 1.4. Tipos de graficos
### Mapas

```{r}
library(rnaturalearth)
library(rnaturalearthdata)
```

```{r}
world <- ne_countries(scale = "medium", returnclass = "sf") # en clase sf
```

---

# 1.4. Tipos de graficos
### Mapas

Coordenadas de Sinaloa approx. 20 grados Norte, 110 grados Oeste (Noroeste)
```{r, fig.height=3}
ggplot()+
    geom_sf(data = world) + #<<
    coord_sf(xlim = c(-110, -105), ylim = c(20, 25), expand = FALSE) #<<
```

---

class: center, middle

# Su turno!

```{r, fig.height=8, echo=FALSE}
knitr::include_graphics('https://images.unsplash.com/photo-1459550190311-6b6947cc215e?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=667&q=80')
```


---


# 1.5. Ejercicios

10 minutos

Crea un grafico de puntos con los datos de Piguinos

1. Carga los datos
```{r}
library(datos)
Pingus<-datos::pinguinos
```

2. Rellena los espacios (*****) para graficar la relacion entre el largo del pico y el largo de la aleta.
```{r}
#ggplot(data=***, mapping=aes(x=***,y=***))+
#  geom_***()
```

---

class: center, middle

# Pausa de 10 minutos

```{r echo=FALSE, out.height=300}
knitr::include_graphics('https://images.unsplash.com/photo-1503481766315-7a586b20f66d?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1335&q=80')
```

---

# 1.5. Ejercicios

## Respuesta
```{r, fig.height=4, warning=FALSE}
ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm))+
  geom_point()
```


---

# 2. Estetica

---

#2.1. Esteticas 
### Colores de los simbolos

```{r, fig.height=5, warning=FALSE}
ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, 
                                color=especie))+ #<<
  geom_point()
```


---

#2.1. Esteticas 
### Temas

Agrege al grafico **theme_bw()**
```{r, fig.height=4, warning=FALSE}
ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))+
  geom_point()+
  theme_bw() #<<
```


---

#2.1. Esteticas 
###  Fondos

```{r, fig.height=4, warning=FALSE}
ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))+
  geom_point()+
  theme_bw()+
  theme(panel.background = element_rect(fill = 'darkblue'))#<<
```

```{r, eval=FALSE}
?theme
```

---

#2.1. Esteticas 
### Modificar ejes

```{r, fig.height=5}
ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))+
  geom_point()+
  theme_bw()+
  xlab('Largo Pico')+ylab('Largo Aleta')#<<
```


---

#2.1. Esteticas 
### Tamanio de letras

```{r, fig.height=5, warning=FALSE}
ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))+
  geom_point()+
  theme_bw()+
  theme(axis.title = element_text(size=20)) #<<
```

---

#2.1. Esteticas 
### Etiquetas

```{r, fig.height=5, warning=FALSE}
ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))+
  geom_point()+
  theme_bw()+
  theme(legend.position = "top") #<<
```

---

# 3.1 Ayuda
## Cheat sheet

Help>CheatSheets>Data Visualization with ggplot

---

# 3.2. Errores comunes
### Orden

No tener los datos ordenados
```{r echo=FALSE, out.height=300}
knitr::include_graphics('https://r4ds-en-espaniol.netlify.app/diagrams_w_text_as_path/es/visualization-stat-bar.svg')
```
De libro R4DS

---

# 3.2. Errores comunes
### Sintaxis

No poner el **+**
```{r}
#ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))
#  geom_point()
```

--

Poner el **+** en el lugar incorrecto
```{r}
#ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))
# +geom_point()
```

--

No cerrar parentesis

```{r}
#ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie)+
# geom_point()
```

---

# 3.3. Ejercicios

Pero primero sepan que pueden guardar su grafico como objeto.
```{r, warning=FALSE}
MiGrafico<-ggplot(data=Pingus, mapping=aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))+
  geom_point()
```

Pueden agregar esteticas a su grafico base con el signo de +
```{r, fig.height=2, warning=FALSE}
MiGrafico+
  theme_bw()+
  theme(legend.position = "top")
```


---

# 3.3. Ejercicios

Tambien sepan que no necesitan escribir todo (data, mapping se puede omitir) si siguen un orden.
```{r, fig.height=2, warning=FALSE}
MiGrafico<-ggplot(Pingus, aes(x=largo_pico_mm,y=largo_aleta_mm, color=especie))+
  geom_point()
MiGrafico
```

---

### Su turno

a) Intenten crear un grafico solos y los asistire si tienen dudas  

b) Les dare instrucciones

Creen un grafico de puntos con los datos de diamantes
```{r}
Diamantes<-datos::diamantes
```

Grafiquen el *precio* por el *quilate* y cambien el color de lo puntos de acuerdo al *corte* y cambien el nombre en el eje x por *Precio en dolares* y el eje y por *kt*.
```{r}
#ggplot(data=***,mapping=aes(x=***, y=***, color=****))+
#  geom_****()+
#  theme_bw()+
#  xlab("**")+ylab("***")
```

```{r, echo=FALSE, eval=FALSE, include=FALSE}
ggplot(data=Diamantes,mapping=aes(x=precio, y=quilate, color=corte))+
  geom_point()+
  theme_bw()+
  xlab("Precio en pesos")+ylab("kt")
```

---


class: center, middle

# Estoy para dudas

```{r echo=FALSE, out.height=300}
knitr::include_graphics('https://images.unsplash.com/photo-1499377193864-82682aefed04?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1361&q=80')
```

---

# 4. Otras posibilidades

---
# 4.1. Animaciones

Los graficos se pueden animar.

```{r, eval=FALSE}
library(gganimate)
```

```{r, echo=FALSE, out.height=200}
knitr::include_graphics('https://www.datanovia.com/en/wp-content/uploads/dn-tutorials/r-tutorial/images/transition_time.gif')
```

--

# 4.2. Inspiracion

[Visualizaciones en R](https://www.notion.so/Data-Viz-Bookmarks-dc01718020bd4fd6a8a4ca80e6bce933) by Silvia Canelón (@spcanelon) and Tom Mock (@thomas_mock)

Twitter:#tidytuesday #DatosDeMiercoles, #30díasdegráficos

---

# Recapitulando

1.1 Teoria.  
1.2 Graficos con ggplot.  
1.3. Practica.  
1.4. Tipos de grafico.  

2.1. Temas.  
2.2. Nombres en los ejes.  
2.3. Colores.  
2.4. Tamanio letras.  

3.1 Ayuda.  
3.2 Errores comunes.  

4.1 Animaciones.  
4.2 Inspiracion.  


