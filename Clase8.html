<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Clase 8</title>
    <meta charset="utf-8" />
    <meta name="author" content="Miriam Lerma" />
    <script src="Clase8_files/header-attrs-2.6/header-attrs.js"></script>
    <link href="Clase8_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <meta name="github-repo" content="MiriamLL/Curso_CIAD"/>
    <meta name="twitter:title" content="Cargar datps"/>
    <meta name="twitter:description" content="Introduccion a RStudioCurso de R"/>
    <meta name="twitter:url" content="https://github.com/MiriamLL/Curso_CIAD/blob/main/Clase3Parte1.html"/>
    <meta name="twitter:image:src" content="https://images.unsplash.com/photo-1525909002-1b05e0c869d8?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=675&amp;q=80"/>
    <meta name="twitter:image:alt" content="Introduccion a R y RStudioCurso de R"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:creator" content="@MiriamLL"/>
    <meta name="twitter:site" content="@MiriamLL"/>
    <meta property="og:title" content="Cargar datps"/>
    <meta property="og:description" content="Introduccion a RStudioCurso de R"/>
    <meta property="og:url" content="https://github.com/MiriamLL/Curso_CIAD/blob/main/Clase3Parte1.html"/>
    <meta property="og:image" content="https://images.unsplash.com/photo-1525909002-1b05e0c869d8?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=675&amp;q=80"/>
    <meta property="og:image:alt" content="Introduccion a R y RStudioCurso de R"/>
    <meta property="og:type" content="website"/>
    <meta property="og:locale" content="en_US"/>
    <meta property="article:author" content="Miriam Lerma"/>
  </head>
  <body>
    <textarea id="source">





class: title-slide, inverse, middle, right
background-image: url(https://images.unsplash.com/photo-1567082534832-01e1a3ac4268?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80)
background-size: cover

### Clase 8
# Factores y &lt;br&gt; Anova

**Miriam Lerma**&lt;br&gt;
Marzo 2021

---

# Intro

- Factores  
- Analisis de varianza (ANOVA)




--

## Ustedes

- Conocimientos de R (saben abrirlo, cargar paquetes y datos, saben hacer operaciones y graficos).  

- Quieren saber como transformar a factor y conocer la sintaxis para hacer analisis de varianza en R.  

--

**Notas** &lt;br&gt;
Ya vieron teoría. &lt;br&gt;
Recuerden que los modelos dependen de sus preguntas y experimentos o muestreos.  

---

# Créditos &amp; materiales:  

- Ejercicios de estadística con R &lt;br&gt; 
[Matias Andina](https://bookdown.org/matiasandina/R-intro/modelos-lineales.html)

- Ejemplos de anovas &lt;br&gt;
[Sthda por Alboukadel Kassambara](http://www.sthda.com/english/wiki/one-way-anova-test-in-r)⭐ 

- Libro &lt;br&gt; 
[Handbook of Regression Models in People Analytics](http://peopleanalytics-regression-book.org/)  

- Tutoriales diversos &lt;br&gt; 
[STAT 545](https://stat545.com/)

- Ejercicios practicos &lt;br&gt; 
[ourcodingclub](https://ourcodingclub.github.io/tutorials/mixed-models/)

- Otros ejemplos:  
[Libro](https://bookdown.org/steve_midway/DAR/understanding-anova-in-r.html)  

- Imágenes adicionales &lt;br&gt; 
[Unsplash](https://unsplash.com/)


---

class: title-slide, inverse, bottom
background-image: url(https://images.unsplash.com/photo-1551415923-31d2072bc248?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=2089&amp;q=80)
background-size: cover

# 1. Factores

---


## 1.1. Titanic

Instalar y cargar el paquete

```r
#install.packages('titanic')
library(titanic)
library(tidyverse)
```

Renombremos el dataframe que vamos a usar y agreguemoslo a nuestro environment.

```r
Titanic_datos&lt;-titanic_train
```

Vamos a usar estos datos por que no están "limpios". 

La idea es que **consideren** que algunas variables se deben transformar a **factores**.

---

## 1.2. Columnas y valores

Renombrar columnas para que estén en español.

```r
Titanic_datos &lt;- Titanic_datos %&gt;%
  rename(sobrevivio=Survived,
         clase=Pclass,
         edad=Age,
         sexo=Sex,
         embarcado=Embarked,
         precio=Fare)
```

Transformamos los espacios vacíos ("") a NA

```r
Titanic_datos$embarcado &lt;- ifelse(Titanic_datos$embarcado == "",
                                 NA,
                                 Titanic_datos$embarcado)
```

---


## 1.3. Factores

Que tipos de datos tenemos?  
- **int**: integral, numérico sin decimales  
- **chr**: character
- **dbl**: double, es un tipo numérico de doble precisión
- **fct**: factor? No hay ninguno con esta clase. 

```r
glimpse(Titanic_datos)
```

```
## Rows: 891
## Columns: 12
## $ PassengerId &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, ...
## $ sobrevivio  &lt;int&gt; 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0...
## $ clase       &lt;int&gt; 3, 1, 3, 1, 3, 3, 1, 3, 3, 2, 3, 1, 3, 3, 3, 2, 3, 2, 3...
## $ Name        &lt;chr&gt; "Braund, Mr. Owen Harris", "Cumings, Mrs. John Bradley ...
## $ sexo        &lt;chr&gt; "male", "female", "female", "female", "male", "male", "...
## $ edad        &lt;dbl&gt; 22, 38, 26, 35, 35, NA, 54, 2, 27, 14, 4, 58, 20, 39, 1...
## $ SibSp       &lt;int&gt; 1, 1, 0, 1, 0, 0, 0, 3, 0, 1, 1, 0, 0, 1, 0, 0, 4, 0, 1...
## $ Parch       &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 5, 0, 0, 1, 0, 0...
## $ Ticket      &lt;chr&gt; "A/5 21171", "PC 17599", "STON/O2. 3101282", "113803", ...
## $ precio      &lt;dbl&gt; 7.2500, 71.2833, 7.9250, 53.1000, 8.0500, 8.4583, 51.86...
## $ Cabin       &lt;chr&gt; "", "C85", "", "C123", "", "", "E46", "", "", "", "G6",...
## $ embarcado   &lt;chr&gt; "S", "C", "S", "S", "S", "Q", "S", "S", "S", "C", "S", ...
```

---

## 1.3. Factores
Transformamos columnas que son factores a factor.  
**fct**: factor? Ahora si existen columnas con esta clase.

```r
Titanic_datos&lt;-Titanic_datos%&gt;%
    mutate(sobrevivio = as_factor(sobrevivio),
           clase = as_factor(clase),
           sexo = as_factor(sexo))
```


```r
glimpse(Titanic_datos)
```

```
## Rows: 891
## Columns: 12
## $ PassengerId &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, ...
## $ sobrevivio  &lt;fct&gt; 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0...
## $ clase       &lt;fct&gt; 3, 1, 3, 1, 3, 3, 1, 3, 3, 2, 3, 1, 3, 3, 3, 2, 3, 2, 3...
## $ Name        &lt;chr&gt; "Braund, Mr. Owen Harris", "Cumings, Mrs. John Bradley ...
## $ sexo        &lt;fct&gt; male, female, female, female, male, male, male, male, f...
## $ edad        &lt;dbl&gt; 22, 38, 26, 35, 35, NA, 54, 2, 27, 14, 4, 58, 20, 39, 1...
## $ SibSp       &lt;int&gt; 1, 1, 0, 1, 0, 0, 0, 3, 0, 1, 1, 0, 0, 1, 0, 0, 4, 0, 1...
## $ Parch       &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 5, 0, 0, 1, 0, 0...
## $ Ticket      &lt;chr&gt; "A/5 21171", "PC 17599", "STON/O2. 3101282", "113803", ...
## $ precio      &lt;dbl&gt; 7.2500, 71.2833, 7.9250, 53.1000, 8.0500, 8.4583, 51.86...
## $ Cabin       &lt;chr&gt; "", "C85", "", "C123", "", "", "E46", "", "", "", "G6",...
## $ embarcado   &lt;chr&gt; "S", "C", "S", "S", "S", "Q", "S", "S", "S", "C", "S", ...
```

---

## 1.4. Sobrevivencia
¿Cuál fue el número de sobrevivientes?  

Vamos a crear un objeto con esa tabla.

```r
Sobrevivientes&lt;-Titanic_datos %&gt;%
          group_by(sobrevivio) %&gt;%
          count()
```

Usaremos la informacion de la tabla que creamos para agregar el numero de sobreviventes.

.pull-left[

```r
g1 &lt;- ggplot(Titanic_datos, 
             aes(sobrevivio)) +
  geom_bar()+
* geom_text(data = Sobrevivientes,
            aes(sobrevivio, 
                y=25, 
                label=n),
            color="white")+
  xlab("sobrevivencia")+
  ylab("Frecuencia")+
  theme_classic()
```
]

.pull-right[
&lt;img src="Clase8_files/figure-html/unnamed-chunk-12-1.png" width="80%" /&gt;
]

**Nuevo concepto** podemos usar _geom_text_ para incluir texto en el gráfico. 

---

## 1.4. Precio

Podemos explorar si los que tenían un boleto mas caro, tenían mas posibilidades de sobrevivir.

.pull-left[

```r
p1 &lt;- ggplot(Titanic_datos, 
             aes(x=sobrevivio, 
                 y=precio)) +
  geom_boxplot()+
  xlab("sobrevivencia")+
  ylab("Precio del boleto")+
  theme_classic()+
  scale_x_discrete(breaks=c("0","1"),
        labels=c("No", "Sí"))
```
]

.pull-right[
&lt;img src="Clase8_files/figure-html/unnamed-chunk-14-1.png" width="80%" /&gt;
]

**Nuevos conceptos**  
- Podemos usar _scale_x_discrete_ para cambiar la etiqueta en el eje _x_.  

---

## 1.5. Clase y edad

Podemos explorar si los que tenian la edad tenia un efecto, ademas de la clase, en las posibilidades de sobrevivir.

.pull-left[

```r
c1&lt;-ggplot(Titanic_datos,
       aes(x= as.factor(clase), edad, 
           fill=sobrevivio))+
  geom_violin()+
  xlab("Clase")+
  ylab("Edad")+
  theme_bw()+
  theme(legend.position='top')+
  scale_fill_brewer(palette = "Set1")
```
]

.pull-right[
&lt;img src="Clase8_files/figure-html/unnamed-chunk-16-1.png" width="80%" /&gt;
]

**Nuevos conceptos**  
- Podemos usar _scale_fill_brewer_ para cambiar los colores de relleno.  


---

## 1.6. Sexo y clase

Podemos explorar los datos separando por sexo, por clase y por si sobrevivieron o no.
.pull-left[

```r
p3&lt;-ggplot(Titanic_datos, 
       aes(sexo, sobrevivio))+
* geom_jitter(aes(color=interaction(factor(sexo),
                                    sobrevivio)))+
  facet_wrap(~clase)+
  ylab("Supervivencia")+
  scale_y_discrete(breaks=c("0","1"),
        labels=c("No", "Sí"))+
  theme(legend.position = "none")+
  scale_color_brewer(palette = "Set2")
```
]

.pull-right[
&lt;img src="Clase8_files/figure-html/unnamed-chunk-18-1.png" width="80%" /&gt;
]

**Nuevos conceptos**  
- Podemos usar _geom_jitter_ para mover los puntos.  
- Podemos usar _scale_color_brewer_ para cambiar los colores de los puntos.  


---

## 1.7. Ejercicios juntos

- Cargar datos de titanic
- Cargar paqueteria tidyverse
- Renombrar objeto
- Renombrar columnas
- Transformar espacios vacíos a NA
- Crear tres gráficos usando precio, clase y edad, y sexo.
- Cambiar clase de columnas a factor

---

## 1.7. Ejercicios juntos

Cargar datos

```r
#install.packages('titanic')
library(titanic)
library(tidyverse)
```

Renombremos el dataframe que vamos a usar y agreguemoslo a nuestro environment.

```r
Titanic_datos&lt;-titanic_train
```

---

## 1.7. Ejercicios juntos

Renombrar columnas para que estén en español.

```r
Titanic_datos &lt;- Titanic_datos %&gt;%
  rename(sobrevivio=Survived,
         clase=Pclass,
         edad=Age,
         sexo=Sex,
         embarcado=Embarked,
         precio=Fare)
```

Transformamos los espacios vacíos ("") a NA

```r
Titanic_datos$embarcado &lt;- ifelse(Titanic_datos$embarcado == "",
                                 NA,
                                 Titanic_datos$embarcado)
```

---

## 1.7. Precio

Prueba con y sin cambiar a factor.

```r
ggplot(Titanic_datos, 
             aes(x=sobrevivio, 
                 y=precio)) +
  geom_boxplot()+
  xlab("sobrevivencia")+
  ylab("Precio del boleto")+
  theme_classic()+
  scale_x_discrete(breaks=c("0","1"),
        labels=c("No", "Sí"))
```

Noten que las clases son 1, 2 y 3 si no le decimos que es **factor**, lo interpreta como **numérico**.

Para transformar a factor.

```r
Titanic_datos$sobrevivio &lt;- as_factor(Titanic_datos$sobrevivio)
```

---

## 1.7. Clase y edad

Prueba con y sin cambiar a factor.

```r
ggplot(Titanic_datos,
       aes(x= as_factor(clase), edad,
           fill=sobrevivio))+
  geom_violin()+
  xlab("Clase")+
  ylab("Edad")+
  theme_bw()+
  theme(legend.position='top')+
  scale_fill_brewer(palette = "Set1")
```

Para transformar a factor.

```r
Titanic_datos$clase &lt;- as_factor(Titanic_datos$clase)
```

---

## 1.7. Sexo y clase

Gráfica la frecuencia del sexo de los pasajeros.

Prueba con y sin cambiar a factor.

```r
ggplot(Titanic_datos, 
       aes(sexo, sobrevivio))+
  geom_jitter(aes(color=interaction(as_factor(sexo), 
                                    sobrevivio)))+
  facet_wrap(~clase)+
  ylab("Supervivencia")+
  scale_y_discrete(breaks=c("0","1"),
        labels=c("No", "Sí"))+
  theme(legend.position = "none")+
  scale_color_brewer(palette = "Set2")
```

Para transformar a factor.

```r
Titanic_datos$sexo &lt;- as.factor(Titanic_datos$sexo)
```

---

class: title-slide, inverse, bottom
background-image: url(https://images.unsplash.com/photo-1567082534832-01e1a3ac4268?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1350&amp;q=80)
background-size: cover

# ANOVAS

---

## 2.1. Teoría

[Teoria](https://rpubs.com/Joaquin_AR/219148)

El análisis de la varianza (ANOVA) se utiliza de forma intensiva en el análisis y diseño de experimentos para evaluar el efecto de tratamientos en la variabilidad de la variable respuesta.  
--
Un análisis de la varianza permite determinar, por ejemplo, si diferentes tratamientos (es decir, un grupo de más de dos tratamientos) muestran diferencias significativas en sus resultados o si por el contrario puede suponerse que sus medias poblacionales no difieren.


---

## 2.2. Insectos

[Ejercicio](https://biocosas.github.io/R/050_anova.html)


Estamos interesados en conocer si hay colores más atractivos para los insectos.  
Para ello se diseñaron trampas con los siguientes colores: amarillo, azul, blanco y verde.  
Se cuantificó el número de insectos que quedaban atrapados.

&lt;br&gt;
&lt;br&gt;
Generemos los datos.

```r
insectos &lt;- c(16,11,20,21,14,7,37,32,15,25,39,
              41,21,12,14,17,13,17,45,59,48,46,38,47)
colores &lt;- as.factor(c(rep(c("azul", "verde", "blanco", "amarillo"), 
                           each=6)))
```

**Nuevo concepto** _rep_ es repetir ese factor, _each_ seis veces.

Crear data frame.

```r
Insectos_df&lt;-data.frame(insectos=insectos,colores=colores)
```

---

## 2.2. Insectos

Exploramos los datos

```r
Trampas_Fig&lt;-ggplot(Insectos_df, 
       aes(x=colores,y=insectos)) +
  geom_boxplot(aes(fill=colores))+
  xlab("Número de insectos atrapados")+
  ylab("Color trampa")+
  theme(legend.position = 'none')+
* scale_fill_manual(values=c("#e9c46a", "#457b9d","#f1faee","#2a9d8f"))
Trampas_Fig
```

![](Clase8_files/figure-html/unnamed-chunk-31-1.png)&lt;!-- --&gt;

**Nuevo concepto** _scale_fill_manual_ sirve para especificar los colores que queremos usar.

---

## 2.3. ANOVA

Esta es la forma de pedir un ANOVA en R:

```r
Anova_insectos&lt;-aov(lm(insectos ~ colores))
```

Elementos generados en el ANOVA:

```r
names(Anova_insectos)
```

```
##  [1] "coefficients"  "residuals"     "effects"       "rank"         
##  [5] "fitted.values" "assign"        "qr"            "df.residual"  
##  [9] "contrasts"     "xlevels"       "call"          "terms"        
## [13] "model"
```

Igual que con los modelos lineares, pedimos un resumen de la tabla del ANOVA

```r
summary(Anova_insectos)
```

```
##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## colores      3   4218    1406   30.55 1.15e-07 ***
## Residuals   20    921      46                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

## 2.3. TukeyHSD

Si hemos detectado diferencias significativas entre las medias de las poblaciones. ¿Sería posible saber cuáles son los grupos que generan estas diferencias?

.pull-left[

```r
Insectos_df %&gt;% 
  group_by(colores) %&gt;%
  summarise(promedio=mean(insectos))
```

```
## # A tibble: 4 x 2
##   colores  promedio
## * &lt;fct&gt;       &lt;dbl&gt;
## 1 amarillo     47.2
## 2 azul         14.8
## 3 blanco       15.7
## 4 verde        31.5
```
]

.pull-right[
&lt;img src="Clase8_files/figure-html/unnamed-chunk-36-1.png" width="80%" /&gt;
]

---

## 2.3. TukeyHSD

Prueba post-hoc.

```r
intervalos&lt;-TukeyHSD(Anova_insectos)
intervalos
```

```
##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = lm(insectos ~ colores))
## 
## $colores
##                        diff        lwr       upr     p adj
## azul-amarillo   -32.3333333 -43.296330 -21.37034 0.0000004
## blanco-amarillo -31.5000000 -42.462996 -20.53700 0.0000006
## verde-amarillo  -15.6666667 -26.629663  -4.70367 0.0036170
## blanco-azul       0.8333333 -10.129663  11.79633 0.9964823
## verde-azul       16.6666667   5.703670  27.62966 0.0020222
## verde-blanco     15.8333333   4.870337  26.79633 0.0032835
```

---

## 2.4. Validación del modelo 


Los supuestos que se deben cumplir son tres: 

- Independencia, 
- homocedasticidad y 
- normalidad.

---

## 2.5. Independencia

Los valores deben ser independientes.

```r
plot(Anova_insectos$residuals)
```

![](Clase8_files/figure-html/unnamed-chunk-38-1.png)&lt;!-- --&gt;

---

## 2.6. Normalidad

El test de Shapiro-Wilk indica que no tenemos evidencia suficiente para rechazar la hipótesis nula (normalidad de los residuos)

```r
shapiro.test(Anova_insectos$residuals)
```

```
## 
## 	Shapiro-Wilk normality test
## 
## data:  Anova_insectos$residuals
## W = 0.97337, p-value = 0.75
```


```r
hist(Anova_insectos$residuals)
```

![](Clase8_files/figure-html/unnamed-chunk-40-1.png)&lt;!-- --&gt;

```r
qqnorm(Anova_insectos$residuals) 
qqline(Anova_insectos$residuals)
```

![](Clase8_files/figure-html/unnamed-chunk-40-2.png)&lt;!-- --&gt;

---

## 2.7. Homocedasticidad

El test de Bartlett indica que no tenemos evidencia suficiente para rechazar la hipótesis nula (las varianzas son iguales)

```r
bartlett.test(Anova_insectos$residuals ~ colores)
```

```
## 
## 	Bartlett test of homogeneity of variances
## 
## data:  Anova_insectos$residuals by colores
## Bartlett's K-squared = 5.2628, df = 3, p-value = 0.1535
```

---

## 2.8. Otras anovas

Crear nueva columna con factor de tamaño.

```r
Insectos_df$tamanio &lt;- as.factor(c(rep(c("grande", "mediana", "chica"), 
                           each=2)))
```

Crear nuevo modelo.

```r
Anova_insectos_2&lt;-aov((insectos ~ colores + tamanio),data=Insectos_df)
```

Resultados del modelo.

```r
summary(Anova_insectos_2)
```

```
##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## colores      3   4218  1406.2   28.96 4.18e-07 ***
## tamanio      2     47    23.3    0.48    0.627    
## Residuals   18    874    48.6                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

## 2.8. Otras anovas

Agregar interacción en el modelo.

```r
Anova_insectos_3&lt;-aov((insectos ~ colores * tamanio),data=Insectos_df)
```

Otra manera de escribir el mismo modelo.

```r
Anova_insectos_4&lt;-aov((insectos ~ colores + tamanio + colores : tamanio),data=Insectos_df)
```

---

##  2.8. Otras anovas

Mismos resultados.

```r
summary(Anova_insectos_3)
```

```
##                 Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## colores          3   4218  1406.2  57.103 2.24e-07 ***
## tamanio          2     47    23.3   0.946   0.4155    
## colores:tamanio  6    578    96.4   3.915   0.0212 *  
## Residuals       12    296    24.6                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```


```r
summary(Anova_insectos_4)
```

```
##                 Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## colores          3   4218  1406.2  57.103 2.24e-07 ***
## tamanio          2     47    23.3   0.946   0.4155    
## colores:tamanio  6    578    96.4   3.915   0.0212 *  
## Residuals       12    296    24.6                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---

## 2.9. Ejercicios juntos

- Generar datos
- Crear modelo
- Ver resultados del modelo
- Verificar algunos supuestos
- Analisis TukeyHSD
- Grafico
- Anova de dos factores
- Anova con interacción


---

## 2.9. Ejercicios juntos

Generar datos y modelo.

```r
insectos &lt;- c(16,11,20,21,14,7,37,32,15,25,39,41,21,12,14,17,13,17,45,59,48,46,38,47)
colores &lt;- as.factor(c(rep(c("azul", "verde", "blanco", "amarillo"), each =6)))
```


```r
Anova_insectos&lt;-aov(lm(insectos ~ colores))
```


```r
summary(Anova_insectos)
```

---


## 2.9. Ejercicios juntos

Independencia

```r
plot(Anova_insectos$residuals)
```

Normalidad

```r
hist(Anova_insectos$residuals)
qqnorm(Anova_insectos$residuals) 
qqline(Anova_insectos$residuals)
```


```r
shapiro.test(Anova_insectos$residuals)
```

Homoscedasticidad

```r
bartlett.test(Anova_insectos$residuals ~ colores)
```

---

## 2.9. Ejercicios juntos

Veamos si los grupos son diferentes y cuales grupos son diferentes.

```r
TukeyHSD(Anova_insectos)
```


```r
Insectos_df&lt;-data.frame(insectos=insectos,colores=colores)
```


```r
ggplot(Insectos_df, aes(x=colores,y=insectos)) +
  geom_boxplot(aes(fill=colores))+
  xlab("Color de la trampa")+
  ylab("Numero de insectos")+
  scale_fill_manual(values=c("#e9c46a", "#457b9d","#f1faee","#2a9d8f"))+
  theme_classic()+
  theme(legend.position = "none")
```

Juega con la grafica, cambiando temas.

---

## 2.9. Ejercicios juntos

Crear nueva columna con factor de tamaño.

```r
Insectos_df$tamanio &lt;- as.factor(c(rep(c("grande", "mediana", "chica"), 
                           each=2)))
```


```r
Anova_insectos_2&lt;-aov((insectos ~ colores + tamanio),data=Insectos_df)
```


```r
summary(Anova_insectos_2)
```

---

## 2.9. Ejercicios juntos

Interacción:

```r
Anova_insectos_3&lt;-aov((insectos ~ colores * tamanio),data=Insectos_df)
```


```r
Anova_insectos_4&lt;-aov((insectos ~ colores + tamanio + colores : tamanio),data=Insectos_df)
```


```r
summary(Anova_insectos_3)
```


```r
summary(Anova_insectos_4)
```

---

class: title-slide, inverse, bottom
background-image: url(https://images.unsplash.com/photo-1567082534832-01e1a3ac4268?ixid=MXwxMjA3fDB8MHxzZWFyY2h8Mnx8YnVtYmxlYmVlfGVufDB8fDB8&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=500&amp;q=60)
background-size: cover


# Recapitulando

8.1. Objetos clase factor.  
8.2. Analisis de varianza.  

Siguiente clase:  
9.1. Basicos en Rmd


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
